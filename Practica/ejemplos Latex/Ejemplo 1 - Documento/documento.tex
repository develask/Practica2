\documentclass[a4paper,10pt]{article}
\usepackage[margin=0.5in]{geometry}
\usepackage{amsthm}
%\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{array}
\usepackage[round]{natbib}
\usepackage{array}
\theoremstyle{plain}
\usepackage{color}
\newtheorem{theo}{Theorem}
\newtheorem{defn}{Definition}

% Redefinimos la funcion \today para ponerla en castellano
\def\today{\number\day~de\space\ifcase\month\or 
  enero\or febrero\or marzo\or abril\or mayo\or junio\or 
  julio\or agosto\or septiembre\or octubre\or noviembre\or diciembre\fi 
  \space de~\number\year}
  
\begin{document}
\author{Mikel de Velasco}
\pagenumbering{roman}
\title{A Note on the Boltzmann Distribution of the Linear Ordering Problem}

\author{Mikel de Velasco, Ieltzu Irazu, Mª In\'es Fernandez}
\date{\today}
\maketitle

\begin{abstract}
In this manuscript, we study the Boltzmann distribution associated to the linear ordering problem. Particularly, we demonstrate that this distribution is L-decomposable. Moreover, we investigate towards an efficient sampling method of the Boltzmann distribution.
\end{abstract}


\section{The Linear Ordering Problem}
As previously mentioned, in this manuscript we are particularly interested in the Boltzmann distribution associated to the Linear Ordering Problem (LOP)~\citep{marti2011,ceberio2014a}. Given a matrix $B = [b_{k,l}]_{n \times n}$ of numerical entries, the LOP consists of finding a simultaneous permutation $\sigma$ of the rows and columns of $B$, such that the sum of the entries above the main diagonal is maximized (or equivalently, the sum of the entries below the main diagonal is minimized). The equation below formalizes the LOP function: \begin{equation}f(\sigma)=\sum_{i=1}^{n-1} \sum_{j=i+1}^n b_{\sigma(i),\sigma(j)}\end{equation}where $\sigma(i)$ denotes the item of the row (and column) ranked at position $i$ in the solution $\sigma$~\footnote{From now on, $\sigma$ will denote any permutation in $\mathbb{S}$$_n$, and $e$ will stand for the identity permutation $(1,2,\ldots,n)$ of size $n$. In addition $k$ and $l$ will denote the items within a permutation $\sigma$, and $i, j$ and $z$ will be used to identify the positions of $\sigma$.}. 

As a particular feature of the LOP, it is worth to remark that the contribution of an item $\sigma(i)$ to the fitness function $f$ depends on the distribution of items in previous $\{1,\ldots,i-1\}$ and posterior $\{i+1,\ldots,n\}$ positions. However, the ordering of the items in each set does not influence the contribution of item $\sigma(i)$. This property of the LOP is of special relevance since the demonstration of the L-decomposability of the Boltzmann distribution is due to it.

\section{The Boltzmann Distribution associated to the LOP}

The \emph{Boltzmann distribution} is an exponential probability distribution that assigns to a state (solution) a probability according to the energy (fitness) of the state. Formally, the Boltzmann distribution of a function $f(\sigma)$ is defined as
\begin{equation}\label{boltz}
P(\sigma)=\frac{\exp(\beta f(\sigma))}{Z(\beta)}
\end{equation}
where $\beta$ denotes the Boltzmann constant, and $Z(\beta)$ is the partition function. When $\beta$ equals 0, $P$ becomes the uniform distribution. In contrast, when $\beta$ is large, the probability concentrates around the optimum. In theory, if it were possible to sample efficiently the Boltzmann distribution for any $\beta$, optimisation would be an easy task~\citep{muhlenbein2003}.

The Boltzmann distribution associated to the LOP is given by
\begin{equation}\label{boltzlop}
P(\sigma)=\frac{\exp(\beta \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} b_{\sigma(i),\sigma(j)})}{Z(\beta)}
\end{equation}
As far as we know, there is no close form expression for $Z(\beta)$, and thus, the only procedure is to calculate it by performing a sum over $\mathbb{S}_n$ as detailed in the following equation:
\begin{equation}\label{boltzZ}
Z(\beta) = \sum_{\sigma\in S_n} \exp \left(\beta \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} b_{\sigma(i),\sigma(j)}\right)
\end{equation}
Note that the time complexity of the procedure above is $O(n!)$, and therefore it is only affordable for instances of $n<15$.

\section{On the L-decomposability of the Boltzmann Distribution associated to the LOP}
The \emph{L-decomposability} is motivated by Luce's ranking postulate which states that the ranking process is assumed to be composed of a sequence of stages. The probability of the ensuing ranking is assumed to be the product of choice probabilities across the various stages.
Formally, choice probabilities constitute a family of probability measures $\{P_B\}$ where $B$ ranges over all subsets of the item labels $\{1,\ldots,n\}$. For each $i\in B$, $P_B(i)$ is the probability that item $i$ is chosen as the most preferred item among those listed in $B$.
Luce's ranking postulate states that for every permutation $\sigma=i_1i_2\ldots i_{n}$, the equation below is true.

\begin{equation}\label{prod}P(\pi)=P_{\{i_1,\ldots,i_n\}}(i_1)\cdot P_{\{i_2,\ldots,i_n\}}(i_2)\cdots P_{\{i_{n-1},i_n\}}(i_{n-1})\end{equation}

Any probability model $P(\sigma)$ which can be expressed in the form~(\ref{prod}) for some collection of choice probabilities is said to be \emph{L-decomposable}~\citep{Critchlow1991}. This property implies that the choice probabilities at $r$-th stage depend only on the set of items remaining at that stage and not on the relative ordering of the $r-1$ items previously selected. Taking into account the comments on the contribution of the items  in the LOP, we propose the following theorem.

\begin{theo}\label{theorem1}
The Boltzmann distribution associated to the linear ordering problem is L-decomposable.
\end{theo}

\begin{proof}
In order to verify that a probability distribution $P(\sigma)$ is L-decomposable, it is a necessary and sufficient condition that for each $r=3,\ldots,n$ and for each $i_1,..., i_r$, the conditional probability
\begin{equation}\label{eq:cond}
P(\sigma(r)=i_r | \sigma(1)=i_1, \ldots, \sigma(r-1)=i_{r-1})
\end{equation}
is a symmetric function of $i_1,\ldots,i_{r-1}$~\citep{Critchlow1991}. Therefore, without loss of generality, by proving the equality below
\begin{equation}\label{demonstrate1}
P(\sigma(r)=i_r | \sigma(1)=i_1, \ldots, \sigma(r-1)=i_{r-1})= P(\sigma(r)=i_r | \sigma(1)=i_{r-1}, \ldots, \sigma(r-1)=i_1)
\end{equation}
we demonstrate that $P(\sigma)$ is L-decomposable.\\

From (\ref{demonstrate1}), by applying the Bayes' theorem, we obtain
\begin{equation}\label{demonstrate2}
\frac{P(\sigma(1)=i_1, \ldots, \sigma(r-1)=i_{r-1}, \sigma(r)=i_r)}{P(\sigma(1)=i_1, \ldots, \sigma(r-1)=i_{r-1})} = \frac{P(\sigma(1)=i_{r-1}, \ldots, \sigma(r-1)=i_{1}, \sigma(r)=i_r)}{P(\sigma(1)=i_{r-1}, \ldots, \sigma(r-1)=i_{1})}
\end{equation}
by replacing the Boltzmann distribution of the LOP (\ref{boltzlop}), we rewrite (\ref{demonstrate2}) as follows
\begin{equation}\label{demonstrate2bis}
\frac{\sum_{\sigma\in C_r}\exp(\beta \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} b_{\sigma(i),\sigma(j)})}{\sum_{\sigma\in C_{r-1}}\exp(\beta \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} b_{\sigma(i),\sigma(j)})}
=
\frac{\sum_{\sigma\in D_r}\exp(\beta \sum_{i=1}^{n-1} \sum_{y=i+1}^{n} b_{\sigma(i),\sigma(j)})}{\sum_{\sigma\in D_{r-1}}\exp(\beta \sum_{i=1}^{n-1} \sum_{j=i+1}^{n} b_{\sigma(i),\sigma(j)})}
\end{equation}
where $C_r$ and $C_{r-1}$ denote the set of permutations that agree with $i_1,\ldots,i_r$ and  $i_1,\ldots,i_{r-1}$ orderings in the first $r$ and $r-1$ positions, and $D_r$ and $D_{r-1}$ denote the set of permutations that agree with $i_{r-1},\ldots,i_1,i_r$ and $i_{r-1},\ldots,i_1$ orderings in the first $r$ and $r-1$ positions. Note that partition functions $Z(\beta)$ are omitted by simple division.\\

By decomposing the fitness function of the left side in (\ref{demonstrate2bis}), we obtain
\begin{equation}
 \frac{\sum_{\sigma\in C_r}{\exp \left(\sum_{i=1}^{r-1}\sum_{j=i+1}^{r} b_{\sigma( i),\sigma( j)}+ \sum_{i=1}^{r}\sum_{j=r+1}^{n} b_{\sigma( i),\sigma( j)} + \sum_{i=r+1}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i),\sigma( j)}\right)}}
{\sum_{\sigma\in C_{r-1}}{\exp \left(\sum_{i=1}^{r-2}\sum_{j=i+1}^{r-1} b_{\sigma( i),\sigma( j)} +\sum_{i=1}^{r-1}\sum_{j=r}^{n} b_{\sigma( i),\sigma( j)} + \sum_{i=r}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i),\sigma( j)}\right) }}
\end{equation}
and extracting the common factor from the dividend and divisor that corresponds to the computation of the $i_1,\ldots,i_{r-1}$ items 
\begin{eqnarray}\label{leftside1}
\frac{\sum_{\sigma\in C_r}{\left[\exp \left(\sum_{i=1}^{r-1}\sum_{j=i+1}^{r} b_{\sigma( i),\sigma ( j )} \right)  \times  \exp\left(\sum_{i=1}^{r}\sum_{j=r+1}^{n} b_{\sigma( i),\sigma( j )} + \sum_{i=r+1}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i),\sigma( j )}\right)\right]}}
{\sum_{\sigma\in C_{r-1}}{\left[\exp \left(\sum_{i=1}^{r-2}\sum_{j=i+1}^{r-1} b_{\sigma( i),\sigma ( j )} \right) \times \exp\left(\sum_{i=1}^{r-1}\sum_{j=r}^{n} b_{\sigma( i),\sigma ( j )} + \sum_{i=r}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i),\sigma ( j )} \right) \right]  }}=
\nonumber\\
\frac{\sum_{\sigma\in C_r}{\left[\exp \left(\sum_{i=1}^{r-2}\sum_{j=i+1}^{r-1} b_{\sigma( i), \sigma ( j )}+ \sum_{i=1}^{r-1} b_{\sigma( i), \sigma ( r)} \right) \times  \exp\left(\sum_{i=1}^{r}\sum_{j=r+1}^{n} b_{\sigma( i), \sigma ( j )} + \sum_{i=r+1}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right)\right]}}
{\sum_{\sigma\in C_{r-1}}{\left[\exp \left(\sum_{i=1}^{r-2}\sum_{j=i+1}^{r-1} b_{\sigma( i), \sigma ( j )} \right) \times \exp\left(\sum_{i=1}^{r-1}\sum_{j=r}^{n} b_{\sigma( i), \sigma ( j )} + \sum_{i=r}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right) \right]  }}\nonumber \\
=
\frac{\sum_{\sigma\in C_r}{\left[\exp \left(\sum_{i=1}^{r-1} b_{\sigma( i), \sigma ( r )} \right) \times  \exp\left(\sum_{i=1}^{r}\sum_{j=r+1}^{n} b_{\sigma( i), \sigma ( j )} + \sum_{i=r+1}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right)\right]}}
{\sum_{\sigma\in C_{r-1}}{\exp\left(\sum_{i=1}^{r-1}\sum_{j=r}^{n} b_{\sigma( i), \sigma ( j )} + \sum_{i=r}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right)}}
\end{eqnarray}\\
Following a similar procedure, we rewrite the right side of (\ref{demonstrate2bis}), 
\[
\frac{
\sum_{\sigma\in D_r}{\left[\exp \left(\sum_{i=1}^{r-2}\sum_{j=i+1}^{r-1} b_{\sigma( i), \sigma ( j )} + \sum_{i=1}^{r-1} b_{\sigma( i), \sigma ( r )} \right) \times  \exp\left(\sum_{i=1}^{r}\sum_{j=r+1}^{n} b_{\sigma( i), \sigma ( j )} + \sum_{i=r+1}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right)\right]}
}
{
\sum_{\sigma\in D_{r-1}}{\left[\exp \left(\sum_{i=1}^{r-2}\sum_{j=i+1}^{r-1} b_{\sigma( i), \sigma ( j )} \right)  \times  \exp\left(\sum_{i=1}^{r-1}\sum_{j=r}^{n} b_{\sigma( i), \sigma ( j )} + \sum_{i=r}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right)\right]}
}
\]
and, as done previously, by extracting the common factor, we obtain
\begin{equation}\label{rightside1}
\frac{\sum_{\sigma\in D_r}{\left[\exp \left(\sum_{i=1}^{r-1} b_{\sigma( i), \sigma ( r)} \right) \times  \exp\left(\sum_{i=1}^{r}\sum_{j=r+1}^{n} b_{\sigma( i), \sigma ( j )} + \sum_{i=r+1}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right)\right]}}
{\sum_{\sigma\in D_{r-1}}{\exp\left(\sum_{i=1}^{r-1}\sum_{j=r}^{n} b_{\sigma( i), \sigma( j )}+ \sum_{i=r}^{n-1}\sum_{j=i+1}^{n} b_{\sigma( i), \sigma ( j )}\right)}}
\end{equation}\\

Since (\ref{leftside1}) and (\ref{rightside1}) are equal, we proved that Eq.~\ref{demonstrate1} is true, and therefore, the Boltzmann distribution of the LOP is {\it L-decomposable}.
\end{proof}

\section*{Acknowledgements}
Thank you every one!

\bibliographystyle{plainnat}
\bibliography{./bibliography.bib}

\end{document}

